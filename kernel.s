;************************************************************************
;	HomebrewOS kernelプログラム
;************************************************************************
;************************************************************************
;	マクロ
;************************************************************************
%include	"../include/define.s"
%include	"../include/macro.s"

		ORG		KERNEL_LOAD				    	; kernelのロードアドレスをアセンブラに指示

[BITS 32]
;************************************************************************
;	エントリポイント
;************************************************************************
kernel:

		mov		ah, 0x04						; AH = 書き込みプレーンを指定（Bit:----IRGB）
		mov		al, 0x02						; AL = マップマスクレジスタ（書き込みプレーンを指定）
		mov		dx, 0x03C4						; DX = シーケンサ制御ポート
		out		dx, ax							; // ポート出力（プレーンの選択）
		mov		[0x000A_0000], byte 0x00		; // ビットパターンの書き込み

		mov		ah, 0x0B						; AH = 書き込みプレーンを指定（Bit:----IRGB）
		out		dx, ax							; // ポート出力（プレーンの選択）
		mov		[0x000A_0000], byte 0xFF

		;---------------------------------------
		; 処理の終了
		;---------------------------------------
		jmp		$								; while (1); // 無限ループ

;************************************************************************
;	パディング
;************************************************************************
		times	KERNEL_SIZE - ($ - $$)	db	0	; パディング
